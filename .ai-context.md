# AI Development Context - Bunkered Golf Platform

## Project Overview

**Bunkered** is a comprehensive golf statistics and betting platform built with a modern tech stack and **mobile-first design principles**. This document provides AI assistants with essential context for development tasks and reflects the complete mobile optimization work completed in 2024.

## Technology Stack

### Frontend

- **Framework**: React 18 with TypeScript (strict mode)
- **Build Tool**: Vite for fast development and building
- **UI Library**: Material-UI (MUI) v5 with extensively customized mobile-first theme
- **State Management**: React Query (@tanstack/react-query) for server state
- **Routing**: React Router v6 with mobile-optimized navigation
- **Styling**: MUI's emotion-based styling system with comprehensive responsive breakpoints

### Backend

- **Framework**: FastAPI with Python 3.9+
- **Database**: PostgreSQL with SQLAlchemy ORM
- **Authentication**: JWT-based authentication with refresh tokens
- **API Documentation**: OpenAPI 3.0 (Swagger) with comprehensive endpoints
- **External APIs**: DataGolf for professional golf statistics

### Infrastructure

- **Containerization**: Docker and Docker Compose for consistent environments
- **Development**: Hot reload for both frontend and backend
- **Database Migration**: Alembic for database versioning
- **Production**: Multi-stage Docker builds with optimization

## Mobile-First Architecture Completed

### 🎯 **Core Mobile Optimizations**

The application has been completely refactored with a mobile-first approach:

#### **Responsive Breakpoints**

```typescript
const breakpoints = {
  xs: 0, // 🤳 Small mobile (320px-599px)
  sm: 600, // 📱 Large mobile (600px-899px)
  md: 900, // 📱 Small tablet (900px-1199px)
  lg: 1200, // 💻 Desktop (1200px-1535px)
  xl: 1536, // 🖥️ Large desktop (1536px+)
};
```

#### **Touch-First Standards**

- **iOS Standards**: 44px minimum touch targets
- **Android Standards**: 48px minimum touch targets
- **Gesture Support**: Swipe, pinch, and tap optimizations
- **Accessibility**: WCAG 2.1 AA compliance throughout

### 🛠 **Completed Component Optimizations**

#### **SortableTable Component (Major Refactor)**

**Location**: `frontend/src/components/common/SortableTable.tsx`

The SortableTable component has been completely overhauled for mobile:

- **Desktop Mode**: Traditional table with sorting, pagination, and column management
- **Mobile Mode**: Intelligent card-based layout with expandable details
- **Adaptive Switching**: Automatic detection and switching based on screen size

**Key Features:**

```typescript
interface Column {
  id: string;
  label: string;
  mobilePriority?: 1 | 2 | 3; // 1=always show, 2=larger mobile, 3=desktop only
  mobileHidden?: boolean; // Hide on mobile, show in expandable section
  mobileFormat?: (value: any, row: any) => React.ReactNode;
  mobileLabel?: string; // Alternative label for mobile cards
}
```

**Mobile Card Layout:**

- **Primary Info**: First 2 high-priority columns displayed prominently
- **Secondary Info**: Additional columns in grid layout
- **Expandable Details**: "Show More" button reveals hidden content
- **Touch Interactions**: Optimized for finger navigation

#### **Navigation Component (Complete Mobile Rewrite)**

**Location**: `frontend/src/components/layout/Navbar.tsx`

- **Desktop**: Horizontal navigation with dropdown menus
- **Mobile**: Slide-out drawer with hierarchical structure
- **User Experience**: Gesture-based interactions and touch-optimized buttons
- **Performance**: Efficient rendering with proper state management

#### **Authentication Pages (Mobile-Optimized)**

**Location**: `frontend/src/pages/Login.tsx`, `frontend/src/pages/Register.tsx`

- **Responsive Layout**: Full-height containers with proper spacing
- **Input Optimization**: 16px font size prevents iOS zoom
- **Touch Targets**: 52px minimum height for form inputs
- **Visual Design**: Professional gradient backgrounds and card layouts

#### **PlayerDetailModal (Mobile-First Redesign)**

**Location**: `frontend/src/components/PlayerDetailModal.tsx`

- **Mobile Behavior**: Full-screen modal with slide-up animation
- **Desktop Behavior**: Traditional modal dialog
- **Content Adaptation**: Stack-based layout for mobile, grid for desktop
- **Performance**: Optimized rendering for large datasets

#### **Theme System (Comprehensive Mobile Overrides)**

**Location**: `frontend/src/theme/index.ts`

**Typography Scaling:**

```typescript
const typography = {
  h1: {
    fontSize: { xs: "1.75rem", sm: "2rem", md: "2.5rem" },
    lineHeight: { xs: 1.2, sm: 1.3 },
  },
  body1: {
    fontSize: { xs: "0.875rem", sm: "1rem" },
    lineHeight: 1.5,
  },
  // ... comprehensive responsive scaling
};
```

**Component Overrides:**

- **MuiButton**: Touch-friendly sizing and spacing
- **MuiCard**: Mobile-specific border radius and padding
- **MuiTable**: Hidden on mobile, replaced with card layouts
- **MuiForm**: Optimized input heights and validation
- **MuiDialog**: Full-screen behavior on mobile

### 📱 **Page-Level Mobile Optimizations**

#### **Dashboard Page**

**Location**: `frontend/src/pages/Dashboard.tsx`

- **Mobile Layout**: Single-column stack with optimized card sizes
- **Quick Actions**: Touch-friendly action buttons
- **Statistics Display**: Condensed metric cards for mobile viewing

#### **Players Page**

**Location**: `frontend/src/pages/Players.tsx`

- **Tabbed Interface**: Mobile-optimized tab navigation
- **Search Integration**: Mobile-friendly search with proper keyboard handling
- **Filter Controls**: Collapsible filter sections for mobile

#### **Tournaments Page**

**Location**: `frontend/src/pages/Tournaments.tsx`

- **Tournament Cards**: Mobile-first card design with essential information
- **Date Filtering**: Mobile-optimized date picker integration
- **Results Display**: Condensed results suitable for small screens

#### **Betting Management**

**Location**: `frontend/src/pages/Bets.tsx`

- **Bet Entry Forms**: Mobile-optimized form layouts
- **Analytics Display**: Mobile-friendly chart components
- **History Management**: Touch-friendly bet management interface

## Development Patterns

### 🎯 **Mobile-First Development Guidelines**

#### **Component Development Pattern**

```typescript
const MyComponent: React.FC<Props> = ({ ...props }) => {
  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down("md"));
  const isSmallMobile = useMediaQuery(theme.breakpoints.down("sm"));

  return (
    <Container
      sx={{
        // Mobile-first: base styles for xs (0px+)
        padding: 2,
        fontSize: "0.875rem",

        // Progressive enhancement for larger screens
        [theme.breakpoints.up("sm")]: {
          padding: 3,
          fontSize: "1rem",
        },
        [theme.breakpoints.up("md")]: {
          padding: 4,
          fontSize: "1.125rem",
        },
      }}
    >
      {/* Conditional rendering for mobile vs desktop */}
      {isMobile ? <MobileLayout /> : <DesktopLayout />}
    </Container>
  );
};
```

#### **Responsive Styling Pattern**

```typescript
// ✅ Correct: Mobile-first responsive styling
const responsiveStyles = {
  // Base styles for mobile (xs: 0px+)
  fontSize: "0.875rem",
  padding: 2,

  // Tablet adjustments (sm: 600px+)
  [theme.breakpoints.up("sm")]: {
    fontSize: "1rem",
    padding: 3,
  },

  // Desktop enhancements (md: 900px+)
  [theme.breakpoints.up("md")]: {
    fontSize: "1.125rem",
    padding: 4,
  },
};

// ❌ Incorrect: Desktop-first approach
const wrongApproach = {
  fontSize: "1.125rem",
  padding: 4,

  [theme.breakpoints.down("md")]: {
    fontSize: "1rem",
    padding: 3,
  },
};
```

#### **Touch Target Optimization**

```typescript
const TouchOptimizedButton = styled(Button)(({ theme }) => ({
  minHeight: 48, // Android minimum
  minWidth: 48,

  [theme.breakpoints.down("sm")]: {
    minHeight: 52, // Optimal mobile size
    minWidth: 52,
  },

  // iOS minimum (44px) is smaller, so 48px covers both
}));
```

### 🗂 **File Organization Patterns**

#### **Component Structure**

```
src/components/
├── common/              # Reusable components
│   ├── SortableTable.tsx    # Mobile-adaptive table/card component
│   ├── LoadingSpinner.tsx   # Responsive loading states
│   └── ErrorBoundary.tsx    # Error handling with mobile messaging
├── layout/              # Layout components
│   ├── Navbar.tsx           # Mobile drawer + desktop navbar
│   └── Footer.tsx           # Responsive footer
└── modals/              # Modal components
    └── PlayerDetailModal.tsx # Full-screen mobile modals
```

#### **Mobile-Specific Utilities**

```typescript
// hooks/useResponsive.ts
export const useResponsive = () => {
  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down("md"));
  const isTablet = useMediaQuery(theme.breakpoints.between("md", "lg"));
  const isDesktop = useMediaQuery(theme.breakpoints.up("lg"));

  return { isMobile, isTablet, isDesktop };
};

// utils/mobile.ts
export const getTouchTargetSize = (isMobile: boolean) => ({
  minHeight: isMobile ? 52 : 44,
  minWidth: isMobile ? 52 : 44,
});

export const getMobileSpacing = (level: number, isMobile: boolean) =>
  isMobile ? Math.max(level * 0.75, 1) : level;
```

## API Integration Patterns

### DataGolf API Integration

**Location**: `backend/app/services/datagolf_service.py`

The application integrates with DataGolf API for comprehensive golf statistics:

#### **Available Endpoints**

- **Player Rankings**: Real-time DataGolf and OWGR rankings
- **Skill Ratings**: Strokes-gained statistics with mobile-optimized display
- **Tournament Data**: Live results and historical performance
- **Course Information**: Detailed course statistics and conditions

#### **Mobile Data Optimization**

```python
class DataGolfService:
    async def get_player_rankings_mobile(self, limit: int = 50):
        """Optimized endpoint for mobile with reduced payload"""
        return await self.get_player_rankings(
            fields=["player_name", "dg_rank", "owgr_rank", "country"],
            limit=limit
        )
```

### Error Handling Patterns

#### **Mobile-Friendly Error Messages**

```typescript
const ErrorDisplay: React.FC<{ error: string }> = ({ error }) => {
  const isMobile = useMediaQuery(theme.breakpoints.down("md"));

  return (
    <Alert
      severity="error"
      sx={{
        fontSize: { xs: "0.875rem", sm: "1rem" },
        borderRadius: { xs: 1, sm: 2 },
        mb: 2,
      }}
    >
      {isMobile ? getShortErrorMessage(error) : error}
    </Alert>
  );
};
```

## Performance Optimization

### 🚀 **Mobile Performance Standards**

#### **Loading Performance**

- **First Contentful Paint**: <1.5s on 3G
- **Largest Contentful Paint**: <2.5s on 3G
- **Time to Interactive**: <3s on 3G
- **Bundle Size**: <200KB initial, <500KB total

#### **Code Splitting Implementation**

```typescript
// pages/index.ts - Lazy loading for mobile optimization
const Dashboard = lazy(() => import("./Dashboard"));
const Players = lazy(() => import("./Players"));
const Bets = lazy(() => import("./Bets"));

// Route configuration with mobile-optimized loading
const AppRoutes = () => (
  <Suspense fallback={<MobileLoadingSpinner />}>
    <Routes>
      <Route path="/dashboard" element={<Dashboard />} />
      <Route path="/players" element={<Players />} />
      <Route path="/bets" element={<Bets />} />
    </Routes>
  </Suspense>
);
```

#### **Image Optimization**

```typescript
const ResponsiveImage: React.FC<ImageProps> = ({ src, alt, ...props }) => (
  <Box
    component="img"
    src={src}
    alt={alt}
    sx={{
      width: "100%",
      height: "auto",
      objectFit: "cover",
      borderRadius: { xs: 1, sm: 2 },
      ...props.sx,
    }}
    loading="lazy"
  />
);
```

## Testing Strategy

### 🧪 **Mobile Testing Approach**

#### **Responsive Testing**

```typescript
// tests/components/SortableTable.test.tsx
describe("SortableTable Mobile Behavior", () => {
  test("switches to card layout on mobile", () => {
    render(<SortableTable {...props} />, {
      wrapper: MockThemeProvider,
      viewport: { width: 375, height: 667 }, // iPhone 8 size
    });

    expect(screen.getByTestId("mobile-card-layout")).toBeInTheDocument();
    expect(screen.queryByTestId("desktop-table")).not.toBeInTheDocument();
  });

  test("handles touch interactions correctly", async () => {
    const user = userEvent.setup();
    render(<SortableTable {...props} />);

    const expandButton = screen.getByText("Show More");
    await user.click(expandButton);

    expect(screen.getByTestId("expanded-content")).toBeInTheDocument();
  });
});
```

#### **Cross-Device Testing**

```typescript
const testViewports = [
  { name: "iPhone 8", width: 375, height: 667 },
  { name: "iPhone 12", width: 390, height: 844 },
  { name: "iPad", width: 768, height: 1024 },
  { name: "Desktop", width: 1920, height: 1080 },
];

testViewports.forEach((viewport) => {
  test(`renders correctly on ${viewport.name}`, () => {
    // Viewport-specific testing
  });
});
```

## Common Development Tasks

### 🔧 **Adding Mobile-Responsive Components**

1. **Start with Mobile Design**: Always design for mobile first
2. **Use Responsive Hooks**: `useMediaQuery` for conditional behavior
3. **Implement Touch Targets**: Minimum 44px/48px for interactive elements
4. **Test Across Devices**: Use browser dev tools and real devices
5. **Optimize Performance**: Consider mobile data constraints

### 📱 **Mobile-Specific Implementation Patterns**

#### **Modal/Dialog Components**

```typescript
const ResponsiveModal: React.FC<ModalProps> = ({ open, onClose, children }) => {
  const isMobile = useMediaQuery(theme.breakpoints.down("md"));

  return (
    <Dialog
      open={open}
      onClose={onClose}
      fullScreen={isMobile}
      maxWidth={isMobile ? false : "md"}
      TransitionComponent={isMobile ? Slide : Fade}
      TransitionProps={isMobile ? { direction: "up" } : {}}
    >
      {children}
    </Dialog>
  );
};
```

#### **Form Components**

```typescript
const MobileOptimizedTextField: React.FC<TextFieldProps> = (props) => (
  <TextField
    {...props}
    sx={{
      "& .MuiInputBase-root": {
        height: { xs: 56, sm: 48 }, // Larger on mobile
      },
      "& .MuiInputBase-input": {
        fontSize: { xs: "16px", sm: "1rem" }, // Prevents iOS zoom
      },
      ...props.sx,
    }}
  />
);
```

#### **Table/List Components**

```typescript
const AdaptiveDataDisplay: React.FC<DataProps> = ({ data, columns }) => {
  const isMobile = useMediaQuery(theme.breakpoints.down("md"));

  return isMobile ? (
    <MobileCardList data={data} columns={columns} />
  ) : (
    <DesktopTable data={data} columns={columns} />
  );
};
```

### 🎨 **Styling Best Practices**

#### **Mobile-First CSS-in-JS**

```typescript
const useStyles = () => ({
  container: {
    // Mobile base styles
    padding: 16,
    fontSize: 14,

    // Progressive enhancement
    [theme.breakpoints.up("sm")]: {
      padding: 24,
      fontSize: 16,
    },
    [theme.breakpoints.up("md")]: {
      padding: 32,
      fontSize: 18,
    },
  },
});
```

#### **Touch-Friendly Interactions**

```typescript
const interactiveStyles = {
  cursor: "pointer",
  transition: "all 0.2s ease",

  "&:hover": {
    transform: { xs: "none", md: "translateY(-2px)" }, // No hover on mobile
    boxShadow: { xs: 1, md: 4 },
  },

  "&:active": {
    transform: "translateY(0px)",
    boxShadow: 1,
  },
};
```

## Security & Performance Considerations

### 🔒 **Mobile Security**

- **Touch ID/Face ID**: Biometric authentication where available
- **Secure Storage**: Local storage encryption for sensitive data
- **Network Security**: Certificate pinning and secure API communication

### ⚡ **Performance Monitoring**

- **Core Web Vitals**: Mobile-specific metrics tracking
- **Bundle Analysis**: Regular bundle size monitoring
- **Device Testing**: Real device performance testing

This comprehensive mobile-first architecture ensures that Bunkered provides an optimal experience across all devices while maintaining feature parity and professional-grade performance.
